=====================================================================
03.10.2022 12:10:10
Task #37177729
Task contextru.ubs.ssbs.billing.BillingTaskContext@25225c92[
springServiceName=billingTaskService,
springServiceMethodName=calculateContract,
taskManager=ru.ubs.ssbs.billing.BillingTaskServiceImpl$BillingTaskManager,
threadCount=32,
taskState=WORK,
message=Расчет заданного периода,
exchangeFormatId=22122706,
userTaskId=37177729,
rangeCount=2,
rangeStart=0,
organisationDatasourceSchema=ssbs-40211,
inputParameters=ru.ubs.ssbs.domain.ContractCriteria@6a8294f8,
goodCount=425,
skipCount=0,
failedCount=1]
=====================================================================
Показания не по всем шкалам на даты: 23.09.2022, 27.09.2022 по услуге Электроэнергия, Электроэнергия день, Электроэнергия день (ГС) НЖ

ru.ubs.ssbs.billing.rule.RuleException: Показания не по всем шкалам на даты: 23.09.2022, 27.09.2022 по услуге Электроэнергия, Электроэнергия день, Электроэнергия день (ГС) НЖ
	at ru.ubs.ssbs.billing.rule.RuleCalcWSByMeteringPointRev2Impl.makeReadings(RuleCalcWSByMeteringPointRev2Impl.scala:267)
	at ru.ubs.ssbs.billing.rule.RuleCalcWSByMeteringPointRev2Impl.$anonfun$splitMeasureUnitByPeriods$2(RuleCalcWSByMeteringPointRev2Impl.scala:490)
	at scala.collection.Iterator$$anon$9.next(Iterator.scala:577)
	at scala.collection.immutable.List.prependedAll(List.scala:153)
	at scala.collection.immutable.List$.from(List.scala:684)
	at scala.collection.immutable.List$.from(List.scala:681)
	at scala.collection.IterableFactory$Delegate.from(Factory.scala:288)
	at scala.collection.immutable.Iterable$.from(Iterable.scala:35)
	at scala.collection.immutable.Iterable$.from(Iterable.scala:32)
	at scala.collection.IterableFactory$Delegate.from(Factory.scala:288)
	at scala.collection.IterableOps.map(Iterable.scala:675)
	at scala.collection.IterableOps.map$(Iterable.scala:675)
	at scala.collection.AbstractIterable.map(Iterable.scala:926)
	at ru.ubs.ssbs.billing.rule.RuleCalcWSByMeteringPointRev2Impl.splitMeasureUnitByPeriods(RuleCalcWSByMeteringPointRev2Impl.scala:484)
	at ru.ubs.ssbs.billing.rule.RuleCalcWSByMeteringPointRev2Impl.$anonfun$calculate$14(RuleCalcWSByMeteringPointRev2Impl.scala:606)
	at scala.collection.StrictOptimizedIterableOps.flatMap(StrictOptimizedIterableOps.scala:118)
	at scala.collection.StrictOptimizedIterableOps.flatMap$(StrictOptimizedIterableOps.scala:105)
	at scala.collection.immutable.HashMap.flatMap(HashMap.scala:39)
	at ru.ubs.ssbs.billing.rule.RuleCalcWSByMeteringPointRev2Impl.calculate(RuleCalcWSByMeteringPointRev2Impl.scala:605)
	at ru.ubs.ssbs.billing.BillingServiceHelper.calculateFacilityRule(BillingServiceHelper.java:269)
	at ru.ubs.ssbs.billing.BillingServiceHelper.calculateFacilityRule(BillingServiceHelper.java:378)
	at ru.ubs.ssbs.billing.BillingTaskServiceImpl.calculateContractItem(BillingTaskServiceImpl.java:1458)
	at ru.ubs.ssbs.billing.BillingTaskServiceImpl.calculateTaskBill(BillingTaskServiceImpl.java:318)
	at ru.ubs.ssbs.billing.BillingTaskServiceImpl$1.onObject(BillingTaskServiceImpl.java:233)
	at ru.ubs.ssbs.billing.BillingTaskServiceImpl$1.onObject(BillingTaskServiceImpl.java:225)
	at ru.ubs.ssbs.exchange.TaskThreadReader.read(TaskThreadReader.java:31)
	at ru.ubs.ssbs.billing.BillingTaskServiceImpl.handleCalculateTaskBill(BillingTaskServiceImpl.java:248)
	at ru.ubs.ssbs.billing.BillingTaskServiceBase.calculateTaskBill(BillingTaskServiceBase.java:453)
	at jdk.internal.reflect.GeneratedMethodAccessor897.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:333)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:190)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)
	at org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:99)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:283)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:96)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:213)
	at jdk.proxy2/jdk.proxy2.$Proxy227.calculateTaskBill(Unknown Source)
	at jdk.internal.reflect.GeneratedMethodAccessor896.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:568)
	at ru.ubs.utils.ObjectUtils.invokeMethod(ObjectUtils.java:384)
	at ru.ubs.ssbs.exchange.TaskServiceImpl.evaluateCurrentContextMethod(TaskServiceImpl.java:816)
	at ru.ubs.ssbs.exchange.TaskServiceImpl.executeBySingleThreadContext(TaskServiceImpl.java:851)
	at ru.ubs.ssbs.exchange.TaskServiceImpl.lambda$executeByThreadContext$36(TaskServiceImpl.java:740)
	at ru.ubs.ssbs.utils.TransactionUtils.inTransaction(TransactionUtils.java:23)
	at ru.ubs.ssbs.exchange.TaskServiceImpl.lambda$executeByThreadContext$39(TaskServiceImpl.java:738)
	at java.base/java.util.concurrent.CompletableFuture$AsyncSupply.run(CompletableFuture.java:1768)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:833)
